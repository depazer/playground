import{B as U,d as D,s as C,q as K,e as B,r as j,O as A,o as k,A as W,l as $,a as e,t as r,w as b,m as y,b as t,L as E,c as w,p as T,F,g as R,x as L,P as H,k as P,T as O,_ as J}from"./index-06e28570.js";import{u as G,_ as Q,a as X}from"./ForceChart.vue_vue_type_script_setup_true_lang-5621f7b0.js";function N(o){return new Promise((n,s)=>{o.oncomplete=o.onsuccess=()=>n(o.result),o.onabort=o.onerror=()=>s(o.error)})}function Y(o,n){const s=indexedDB.open(o);s.onupgradeneeded=()=>s.result.createObjectStore(n);const c=N(s);return(p,g)=>c.then(_=>g(_.transaction(n,p).objectStore(n)))}let S;function M(){return S||(S=Y("keyval-store","keyval")),S}function Z(o,n=M()){return n("readonly",s=>N(s.get(o)))}function q(o,n,s=M()){return s("readwrite",c=>(c.put(n,o),N(c.transaction)))}async function ee(o,n,s){const c=`${s||"https://registry.npmjs.org/"}${o}/${n}`,p=n===""?void 0:await Z(c);if(p)return{data:p,error:void 0};const{data:g,error:_}=await U(c,{headers:{"Content-Type":"application/json"},method:"GET"},{afterFetch({data:f}){return n!==""&&q(c,f),{data:f}}}).json();return{error:_.value,data:g.value}}const te={class:"rounded bg-indigo-3 px-1 font-sans text-indigo-8 dark:bg-blue-6 dark:text-blue-2"},se={class:"flex-grow overflow-auto"},ne={class:"select-none mt-2 flex justify-between items-center gap-2"},oe={class:"mr-2 font-bold"},ae={class:"rounded bg-lime-2 px-1 font-sans text-lime-6 dark:bg-lime-6 dark:text-lime-1"},re=e("i",{class:"i-uil-location-point",text:"lg red"},null,-1),ce=[re],le=e("i",{class:"i-uil-focus-target",text:"lg green-6"},null,-1),de=[le],ie={class:"my-4"},ue={class:"select-none font-bold"},pe={class:"my-2"},ge={class:"select-none flex flex-wrap justify-between gap-2"},_e={"my-1":""},fe={class:"mr-2 font-bold"},he={"font-sans":""},me={"my-1":""},ke={class:"mr-2 font-bold"},ve={"font-sans":""},be={class:"select-none"},ye={class:"mr-2 font-bold"},we={class:"rounded-sm bg-red-1 px-1 font-sans text-red-6 dark:bg-red-1/30 dark:text-red-3"},xe={class:"my-4 select-none"},$e={class:"mr-2 font-bold"},Pe={flex:"~ wrap items-start",class:"mt-2 gap-1"},Se={flex:"~ wrap col items-start",class:"my-4 gap-1"},Ce={class:"select-none font-bold"},Ne={class:"animate-pulse py-4"},Ie=e("span",{class:"mr-2 inline-block h-4 w-1/4 rounded bg-gray"},null,-1),Ve=e("span",{class:"inline-block h-4 w-1/3 rounded bg-gray"},null,-1),ze=e("p",{class:"h-4 rounded bg-gray"},null,-1),Be=e("p",{class:"h-4 w-3/4 rounded bg-gray"},null,-1),je=e("p",{class:"h-4 rounded bg-gray"},null,-1),Te=e("p",{class:"h-4 rounded bg-gray"},null,-1),Fe=[Ie,Ve,ze,Be,je,Te],Oe=D({__name:"PackageInfo",props:{currentPackage:{},modelValue:{}},emits:["update:modelValue"],setup(o,{emit:n}){const s=o,c=G(),{currentRegistry:p}=C(c),{isPackedNode:g,togglePackedNode:_,moduleConfig:f}=K(),h=B(()=>s.currentPackage.name+"@"+s.currentPackage.version),m=j(!1),l=j();A(async a=>{if(s.currentPackage.name+s.currentPackage.version==="")return;m.value=!0;const{data:d}=await ee(s.currentPackage.name,s.currentPackage.version,p.value);l.value=d;const v=setTimeout(()=>m.value=!1,300);a(()=>clearTimeout(v))});const u=B(()=>{var a,d,v,i,x,I,V,z;return{description:((a=l.value)==null?void 0:a.description)??"无",dist:{size:(v=(d=l.value)==null?void 0:d.dist)!=null&&v.size?(l.value.dist.size/1024).toFixed(2)+"KB":"UNKNOWN",unpackedSize:(x=(i=l.value)==null?void 0:i.dist)!=null&&x.unpackedSize?(l.value.dist.unpackedSize/1024).toFixed(2)+"KB":"UNKNOWN"},license:((I=l.value)==null?void 0:I.license)??"UNKNOWN",keywords:((V=l.value)==null?void 0:V.keywords)??[],dependencies:Object.entries(((z=l.value)==null?void 0:z.dependencies)??{})}});return(a,d)=>(k(),W(Q,{class:"h-[calc(100vh-8rem)] w-xs"},{header:$(()=>[e("code",te,r(a.currentPackage.name),1)]),default:$(()=>{var v;return[b(e("section",se,[e("div",ne,[e("div",null,[e("span",oe,r(a.$t("packageInfo.version")),1),e("code",ae,r(a.currentPackage.version),1)]),e("div",null,[e("button",{type:"button",title:"断开依赖项链接",class:"ma-0 rounded-md border-none pa-1",bg:"transparent hover:gray-2 hover:dark:slate-8",onClick:d[0]||(d[0]=i=>t(_)(t(h)))},[e("i",{class:E(t(g)(t(h))?"i-uil-plus":"i-uil-link-broken"),text:"lg orange-5 dark:orange-3"},null,2)]),b(e("button",{type:"button",title:"设为根节点",class:"ma-0 rounded-md border-none pa-1",bg:"transparent hover:gray-2 hover:dark:slate-8",onClick:d[1]||(d[1]=i=>n("update:modelValue",t(h)))},ce,512),[[y,a.currentPackage.version.match(/^\d/)&&t(f).rootModule!==t(h)]]),b(e("button",{type:"button",title:"返回主节点",class:"ma-0 rounded-md border-none pa-1",bg:"transparent hover:gray-2 hover:dark:slate-8",onClick:d[2]||(d[2]=i=>n("update:modelValue",""))},de,512),[[y,a.modelValue!==""]])])]),e("div",ie,[e("span",ue,r(a.$t("packageInfo.description")),1),e("p",pe,r(t(u).description),1)]),e("div",ge,[e("p",_e,[e("span",fe,r(a.$t("packageInfo.size")),1),e("code",he,r(t(u).dist.size),1)]),e("p",me,[e("span",ke,r(a.$t("packageInfo.unpackedSize")),1),e("code",ve,r(t(u).dist.unpackedSize),1)])]),e("p",be,[e("span",ye,r(a.$t("packageInfo.license")),1),e("code",we,r((v=t(l))==null?void 0:v.license),1)]),b(e("div",xe,[e("span",$e,r(a.$t("packageInfo.keywords")),1),e("div",Pe,[(k(!0),w(F,null,T(t(u).keywords,i=>(k(),w("code",{class:"rounded-sm bg-cyan-1 px-1 font-sans text-cyan-6 dark:bg-cyan-1/30 dark:text-cyan-3",key:i},r(i),1))),128))])],512),[[y,t(u).keywords.length]]),b(e("div",Se,[e("span",Ce,r(a.$t("packageInfo.dependencies")),1),(k(!0),w(F,null,T(t(u).dependencies,([i,x])=>(k(),w("li",{class:"px-1",key:i+x},r(i)+"@"+r(x),1))),128))],512),[[y,t(u).dependencies.length!==0]])],512),[[y,!t(m)]]),b(e("section",Ne,Fe,512),[[y,t(m)]])]}),_:1}))}}),De={class:"h-100vh w-full overflow-hidden"},Ke={key:1,class:"i-svg-spinners-blocks-shuffle-3 absolute left-[calc(50%-3rem)] top-[calc(50%-3rem)] text-8xl"},We={class:"absolute left-4 top-16"},Ge=D({__name:"index",setup(o){const{packageInfoCardVisible:n}=C(G()),s=R(n),c=L({name:"",version:""});function p(m){s(!0),c.version=m.split("@").slice(-1)[0],c.name=m.split("@").slice(0,-1).join("@")}const{graphData:g,moduleConfig:_}=C(K()),{width:f,height:h}=H();return(m,l)=>(k(),w("div",De,[P(O,{name:"chart"},{default:$(()=>[t(g).nodes.length?(k(),W(X,{key:0,width:t(f),height:t(h),viewBox:`${-t(f)/2} ${-t(h)/2} ${t(f)} ${t(h)}`,onNodeClick:p,graphData:t(g)},null,8,["width","height","viewBox","graphData"])):(k(),w("i",Ke))]),_:1}),P(O,{name:"package-info"},{default:$(()=>[b(e("aside",We,[P(Oe,{modelValue:t(_).rootModule,"onUpdate:modelValue":l[0]||(l[0]=u=>t(_).rootModule=u),currentPackage:t(c),onClose:t(s)},null,8,["modelValue","currentPackage","onClose"])],512),[[y,t(n)]])]),_:1})]))}});const Ae=J(Ge,[["__scopeId","data-v-17e368f1"]]);export{Ae as default};
