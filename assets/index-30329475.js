import{B as U,d as O,s as S,q as D,e as z,r as B,O as A,o as m,A as K,l as x,a as e,t as r,w as v,m as b,b as t,L as E,c as y,p as j,F as T,g as M,x as R,P as L,k as $,T as F,_ as H}from"./index-728851a6.js";import{u as W,_ as J,a as Q}from"./ForceChart.vue_vue_type_script_setup_true_lang-0ad3b4fc.js";function N(a){return new Promise((n,s)=>{a.oncomplete=a.onsuccess=()=>n(a.result),a.onabort=a.onerror=()=>s(a.error)})}function X(a,n){const s=indexedDB.open(a);s.onupgradeneeded=()=>s.result.createObjectStore(n);const c=N(s);return(_,g)=>c.then(f=>g(f.transaction(n,_).objectStore(n)))}let P;function G(){return P||(P=X("keyval-store","keyval")),P}function Y(a,n=G()){return n("readonly",s=>N(s.get(a)))}function Z(a,n,s=G()){return s("readwrite",c=>(c.put(n,a),N(c.transaction)))}async function q(a,n,s){const c=`${s||"https://registry.npmjs.org/"}${a}/${n}`,_=n===""?void 0:await Y(c);if(_)return{data:_,error:void 0};const{data:g,error:f}=await U(c,{headers:{"Content-Type":"application/json"},method:"GET"},{afterFetch({data:u}){return n!==""&&Z(c,u),{data:u}}}).json();return{error:f.value,data:g.value}}const ee={class:"rounded bg-indigo-3 px-1 font-sans text-indigo-8 dark:bg-blue-6 dark:text-blue-2"},te={class:"flex-grow overflow-auto"},se={class:"select-none mt-2 flex justify-between items-center gap-2"},ne={class:"mr-2 font-bold"},oe={class:"rounded bg-lime-2 px-1 font-sans text-lime-6 dark:bg-lime-6 dark:text-lime-1"},ae=e("i",{class:"i-uil-location-point",text:"lg red"},null,-1),re=[ae],ce=e("i",{class:"i-uil-focus-target",text:"lg green-6"},null,-1),le=[ce],de={class:"my-4"},ie={class:"select-none font-bold"},ue={class:"my-2"},pe={class:"select-none flex flex-wrap justify-between gap-2"},_e={"my-1":""},ge={class:"mr-2 font-bold"},fe={"font-sans":""},he={"my-1":""},me={class:"mr-2 font-bold"},ke={"font-sans":""},ve={class:"select-none"},be={class:"mr-2 font-bold"},ye={class:"rounded-sm bg-red-1 px-1 font-sans text-red-6 dark:bg-red-1/30 dark:text-red-3"},we={class:"my-4 select-none"},xe={class:"mr-2 font-bold"},$e={flex:"~ wrap items-start",class:"mt-2 gap-1"},Pe={flex:"~ wrap col items-start",class:"my-4 gap-1"},Se={class:"select-none font-bold"},Ne={class:"animate-pulse py-4"},Ce=e("span",{class:"mr-2 inline-block h-4 w-1/4 rounded bg-gray"},null,-1),Ie=e("span",{class:"inline-block h-4 w-1/3 rounded bg-gray"},null,-1),Ve=e("p",{class:"h-4 rounded bg-gray"},null,-1),ze=e("p",{class:"h-4 w-3/4 rounded bg-gray"},null,-1),Be=e("p",{class:"h-4 rounded bg-gray"},null,-1),je=e("p",{class:"h-4 rounded bg-gray"},null,-1),Te=[Ce,Ie,Ve,ze,Be,je],Fe=O({__name:"PackageInfo",props:{currentPackage:{},modelValue:{}},emits:["update:modelValue"],setup(a,{emit:n}){const s=a,c=W(),{currentRegistry:_}=S(c),{isPackedNode:g,togglePackedNode:f}=D(),u=z(()=>s.currentPackage.name+"@"+s.currentPackage.version),h=B(!1),l=B();A(async o=>{if(s.currentPackage.name+s.currentPackage.version==="")return;h.value=!0;const{data:d}=await q(s.currentPackage.name,s.currentPackage.version,_.value);l.value=d;const k=setTimeout(()=>h.value=!1,300);o(()=>clearTimeout(k))});const p=z(()=>{var o,d,k,i,w,C,I,V;return{description:((o=l.value)==null?void 0:o.description)??"无",dist:{size:(k=(d=l.value)==null?void 0:d.dist)!=null&&k.size?(l.value.dist.size/1024).toFixed(2)+"KB":"UNKNOWN",unpackedSize:(w=(i=l.value)==null?void 0:i.dist)!=null&&w.unpackedSize?(l.value.dist.unpackedSize/1024).toFixed(2)+"KB":"UNKNOWN"},license:((C=l.value)==null?void 0:C.license)??"UNKNOWN",keywords:((I=l.value)==null?void 0:I.keywords)??[],dependencies:Object.entries(((V=l.value)==null?void 0:V.dependencies)??{})}});return(o,d)=>(m(),K(J,{class:"h-[calc(100vh-8rem)] w-xs"},{header:x(()=>[e("code",ee,r(o.currentPackage.name),1)]),default:x(()=>{var k;return[v(e("section",te,[e("div",se,[e("div",null,[e("span",ne,r(o.$t("packageInfo.version")),1),e("code",oe,r(o.currentPackage.version),1)]),e("div",null,[e("button",{type:"button",title:"断开依赖项链接",class:"ma-0 rounded-md border-none pa-1",bg:"transparent hover:gray-2 hover:dark:slate-8",onClick:d[0]||(d[0]=i=>t(f)(t(u)))},[e("i",{class:E(t(g)(t(u))?"i-uil-plus":"i-uil-link-broken"),text:"lg red-3"},null,2)]),v(e("button",{type:"button",title:"设为根节点",class:"ma-0 rounded-md border-none pa-1",bg:"transparent hover:gray-2 hover:dark:slate-8",onClick:d[1]||(d[1]=i=>n("update:modelValue",t(u)))},re,512),[[b,o.currentPackage.version.match(/^\d/)]]),v(e("button",{type:"button",title:"返回主节点",class:"ma-0 rounded-md border-none pa-1",bg:"transparent hover:gray-2 hover:dark:slate-8",onClick:d[2]||(d[2]=i=>n("update:modelValue",""))},le,512),[[b,o.modelValue!==""]])])]),e("div",de,[e("span",ie,r(o.$t("packageInfo.description")),1),e("p",ue,r(t(p).description),1)]),e("div",pe,[e("p",_e,[e("span",ge,r(o.$t("packageInfo.size")),1),e("code",fe,r(t(p).dist.size),1)]),e("p",he,[e("span",me,r(o.$t("packageInfo.unpackedSize")),1),e("code",ke,r(t(p).dist.unpackedSize),1)])]),e("p",ve,[e("span",be,r(o.$t("packageInfo.license")),1),e("code",ye,r((k=t(l))==null?void 0:k.license),1)]),v(e("div",we,[e("span",xe,r(o.$t("packageInfo.keywords")),1),e("div",$e,[(m(!0),y(T,null,j(t(p).keywords,i=>(m(),y("code",{class:"rounded-sm bg-cyan-1 px-1 font-sans text-cyan-6 dark:bg-cyan-1/30 dark:text-cyan-3",key:i},r(i),1))),128))])],512),[[b,t(p).keywords.length]]),v(e("div",Pe,[e("span",Se,r(o.$t("packageInfo.dependencies")),1),(m(!0),y(T,null,j(t(p).dependencies,([i,w])=>(m(),y("li",{class:"px-1",key:i+w},r(i)+"@"+r(w),1))),128))],512),[[b,t(p).dependencies.length!==0]])],512),[[b,!t(h)]]),v(e("section",Ne,Te,512),[[b,t(h)]])]}),_:1}))}}),Oe={class:"h-100vh w-full overflow-hidden"},De={key:1,class:"i-svg-spinners-blocks-shuffle-3 absolute left-[calc(50%-3rem)] top-[calc(50%-3rem)] text-8xl"},Ke={class:"absolute left-4 top-16"},We=O({__name:"index",setup(a){const{packageInfoCardVisible:n}=S(W()),s=M(n),c=R({name:"",version:""});function _(l){s(!0),c.version=l.split("@").slice(-1)[0],c.name=l.split("@").slice(0,-1).join("@")}const{graphData:g,moduleConfig:f}=S(D()),{width:u,height:h}=L();return(l,p)=>(m(),y("div",Oe,[$(F,{name:"chart"},{default:x(()=>[t(g).nodes.length?(m(),K(Q,{key:0,width:t(u),height:t(h),viewBox:`${-t(u)/2} ${-t(h)/2} ${t(u)} ${t(h)}`,onNodeClick:_,graphData:t(g)},null,8,["width","height","viewBox","graphData"])):(m(),y("i",De))]),_:1}),$(F,{name:"package-info"},{default:x(()=>[v(e("aside",Ke,[$(Fe,{modelValue:t(f).rootModule,"onUpdate:modelValue":p[0]||(p[0]=o=>t(f).rootModule=o),currentPackage:t(c),onClose:t(s)},null,8,["modelValue","currentPackage","onClose"])],512),[[b,t(n)]])]),_:1})]))}});const Ae=H(We,[["__scopeId","data-v-17e368f1"]]);export{Ae as default};
