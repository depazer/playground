(function(){"use strict";const n={dependencyNodes:[],packedNodes:[],loopLinks:[],id:-1};self.onmessage=d=>{const{type:s,data:e}=d.data;switch(s){case 0:n.id=Math.random(),n.dependencyNodes=e.dependency.dependencyNodes,n.loopLinks=r(e.dependency.loopDependencies),n.packedNodes=e.packedNodes,k(n.id,e.rootDependency);break}};function r(d){const s=new Set;for(const e of d)for(const[c,i]of e.slice(1).entries())s.add(`${e[c]}->${i}`);return[...s]}function k(d,s){const e=n.dependencyNodes,i=s===""?e[0]:e.find(({name:o})=>o===s),t=[],a=[],p=new Set;i&&l(i);function l(o){p.add(o.name),t.push(o),a.push(...u(o.name,o.dependencies)),o.dependencies.forEach(f=>{!p.has(f)&&!n.packedNodes.includes(o.name)&&l(e.find(L=>L.name===f))})}if(n.id===d)self.postMessage({type:0,data:{nodes:t,links:a}});else return}function u(d,s){return n.packedNodes.includes(d)?[]:s.map(e=>{const c=n.dependencyNodes.find(i=>i.name===e);return{source:d,target:e,linkColor:y((c==null?void 0:c.isDevDependency)??!1,n.loopLinks.includes(`${d}->${e}`))}})}function y(d,s){return{"00":"#c792ce","01":"#ff536d",11:"#ff536d",10:"#82aae0"}[`${+d}${+s}`]}})();
