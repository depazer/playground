import{B as R,d as G,s as N,q as M,e as F,r as O,O as L,o as h,A as U,l as C,a as e,t as a,w as b,m as v,b as t,N as H,c as y,p as D,F as K,g as J,x as Q,P as X,k as I,T as W,_ as Y}from"./index-623c5cdb.js";import{u as A,_ as Z,a as q}from"./ForceChart.vue_vue_type_script_setup_true_lang-046d3149.js";function V(o){return new Promise((n,s)=>{o.oncomplete=o.onsuccess=()=>n(o.result),o.onabort=o.onerror=()=>s(o.error)})}function ee(o,n){const s=indexedDB.open(o);s.onupgradeneeded=()=>s.result.createObjectStore(n);const i=V(s);return(g,u)=>i.then(f=>u(f.transaction(n,g).objectStore(n)))}let z;function E(){return z||(z=ee("keyval-store","keyval")),z}function te(o,n=E()){return n("readonly",s=>V(s.get(o)))}function se(o,n,s=E()){return s("readwrite",i=>(i.put(n,o),V(i.transaction)))}async function ne(o,n,s){const i=`${s||"https://registry.npmjs.org/"}${o}/${n}`,g=n===""?void 0:await te(i);if(g)return{data:g,error:void 0};const{data:u,error:f}=await R(i,{headers:{"Content-Type":"application/json"},method:"GET"},{afterFetch({data:p}){return n!==""&&se(i,p),{data:p}}}).json();return{error:f.value,data:u.value}}const oe={class:"rounded bg-indigo-3 px-1 font-sans text-indigo-8 dark:bg-blue-6 dark:text-blue-2"},ae={class:"flex-grow overflow-auto"},ce={class:"select-none mt-2 flex justify-between items-center gap-2"},ie={class:"mr-2 font-bold"},le={class:"rounded bg-lime-2 px-1 font-sans text-lime-6 dark:bg-lime-6 dark:text-lime-1"},re=e("i",{class:"i-uil-location-point",text:"lg lime-7 dark:lime"},null,-1),de=[re],ue=["title"],pe=e("i",{class:"i-uil-channel-add",text:"lg indigo"},null,-1),_e=[pe],ge=e("i",{class:"i-uil-fidget-spinner",text:"lg orange"},null,-1),fe=[ge],he={class:"my-4"},me={class:"select-none font-bold"},ke={class:"my-2"},be={class:"select-none flex flex-wrap justify-between gap-2"},ve={"my-1":""},ye={class:"mr-2 font-bold"},we={"font-sans":""},xe={"my-1":""},$e={class:"mr-2 font-bold"},Pe={"font-sans":""},Se={class:"select-none"},Ne={class:"mr-2 font-bold"},Ce={class:"rounded-sm bg-red-1 px-1 font-sans text-red-6 dark:bg-red-1/30 dark:text-red-3"},Ie={class:"my-4 select-none"},ze={class:"mr-2 font-bold"},Ve={flex:"~ wrap items-start",class:"mt-2 gap-1"},Be={flex:"~ wrap col items-start",class:"my-4 gap-1"},je={class:"select-none font-bold"},Te={class:"animate-pulse py-4"},Fe=e("span",{class:"mr-2 inline-block h-4 w-1/4 rounded bg-gray"},null,-1),Oe=e("span",{class:"inline-block h-4 w-1/3 rounded bg-gray"},null,-1),De=e("p",{class:"h-4 rounded bg-gray"},null,-1),Ke=e("p",{class:"h-4 w-3/4 rounded bg-gray"},null,-1),We=e("p",{class:"h-4 rounded bg-gray"},null,-1),Ge=e("p",{class:"h-4 rounded bg-gray"},null,-1),Me=[Fe,Oe,De,Ke,We,Ge],Ue=G({__name:"PackageInfo",props:{currentPackage:{},modelValue:{}},emits:["update:modelValue"],setup(o,{emit:n}){const s=o,i=A(),{currentRegistry:g}=N(i),u=M(),{moduleConfig:f}=N(u),{isPackedNode:p,togglePackedNode:w,packSubNodes:x,unPackSubNodes:P}=u,_=F(()=>s.currentPackage.name+"@"+s.currentPackage.version),S=O(!1),d=O();L(async c=>{if(s.currentPackage.name+s.currentPackage.version==="")return;S.value=!0;const{data:l}=await ne(s.currentPackage.name,s.currentPackage.version,g.value);d.value=l;const k=setTimeout(()=>S.value=!1,300);c(()=>clearTimeout(k))});const m=F(()=>{var c,l,k,r,$,B,j,T;return{description:((c=d.value)==null?void 0:c.description)??"无",dist:{size:(k=(l=d.value)==null?void 0:l.dist)!=null&&k.size?(d.value.dist.size/1024).toFixed(2)+"KB":"UNKNOWN",unpackedSize:($=(r=d.value)==null?void 0:r.dist)!=null&&$.unpackedSize?(d.value.dist.unpackedSize/1024).toFixed(2)+"KB":"UNKNOWN"},license:((B=d.value)==null?void 0:B.license)??"UNKNOWN",keywords:((j=d.value)==null?void 0:j.keywords)??[],dependencies:Object.entries(((T=d.value)==null?void 0:T.dependencies)??{})}});return(c,l)=>(h(),U(Z,{class:"h-[calc(100vh-8rem)] w-xs"},{header:C(()=>[e("code",oe,a(c.currentPackage.name),1)]),default:C(()=>{var k;return[b(e("section",ae,[e("div",ce,[e("div",null,[e("span",ie,a(c.$t("packageInfo.version")),1),e("code",le,a(c.currentPackage.version),1)]),e("div",null,[b(e("button",{type:"button",title:"设为根节点",class:"icon-button",onClick:l[0]||(l[0]=r=>n("update:modelValue",t(_)))},de,512),[[v,c.currentPackage.version.match(/^\d/)&&t(f).rootModule!==t(_)]]),e("button",{type:"button",title:t(p)(t(_))?"展开自身依赖":"收起自身依赖",class:"icon-button",onClick:l[1]||(l[1]=r=>t(w)(t(_)))},[e("i",{class:H(t(p)(t(_))?"i-uil-plus":"i-uil-link-broken"),text:"lg red dark:red-3"},null,2)],8,ue),e("button",{type:"button",title:"展开子依赖",class:"icon-button",onClick:l[2]||(l[2]=r=>t(P)(t(_)))},_e),e("button",{type:"button",title:"显示一层子依赖",class:"icon-button",onClick:l[3]||(l[3]=r=>t(x)(t(_)))},fe)])]),e("div",he,[e("span",me,a(c.$t("packageInfo.description")),1),e("p",ke,a(t(m).description),1)]),e("div",be,[e("p",ve,[e("span",ye,a(c.$t("packageInfo.size")),1),e("code",we,a(t(m).dist.size),1)]),e("p",xe,[e("span",$e,a(c.$t("packageInfo.unpackedSize")),1),e("code",Pe,a(t(m).dist.unpackedSize),1)])]),e("p",Se,[e("span",Ne,a(c.$t("packageInfo.license")),1),e("code",Ce,a((k=t(d))==null?void 0:k.license),1)]),b(e("div",Ie,[e("span",ze,a(c.$t("packageInfo.keywords")),1),e("div",Ve,[(h(!0),y(K,null,D(t(m).keywords,r=>(h(),y("code",{class:"rounded-sm bg-cyan-1 px-1 font-sans text-cyan-6 dark:bg-cyan-1/30 dark:text-cyan-3",key:r},a(r),1))),128))])],512),[[v,t(m).keywords.length]]),b(e("div",Be,[e("span",je,a(c.$t("packageInfo.dependencies")),1),(h(!0),y(K,null,D(t(m).dependencies,([r,$])=>(h(),y("li",{class:"px-1",key:r+$},a(r)+"@"+a($),1))),128))],512),[[v,t(m).dependencies.length!==0]])],512),[[v,!t(S)]]),b(e("section",Te,Me,512),[[v,t(S)]])]}),_:1}))}}),Ae={class:"h-100vh w-full overflow-hidden"},Ee={key:1,class:"i-svg-spinners-blocks-shuffle-3 absolute left-[calc(50%-3rem)] top-[calc(50%-3rem)] text-8xl"},Re={class:"absolute left-4 top-16"},Le=G({__name:"index",setup(o){const{packageInfoCardVisible:n}=N(A()),s=J(n),i=Q({name:"",version:""});function g(x){s(!0),i.version=x.split("@").slice(-1)[0],i.name=x.split("@").slice(0,-1).join("@")}const{graphData:u,moduleConfig:f}=N(M()),{width:p,height:w}=X();return(x,P)=>(h(),y("div",Ae,[I(W,{name:"chart"},{default:C(()=>[t(u).nodes.length?(h(),U(q,{key:0,width:t(p),height:t(w),viewBox:`${-t(p)/2} ${-t(w)/2} ${t(p)} ${t(w)}`,onNodeClick:g,graphData:t(u)},null,8,["width","height","viewBox","graphData"])):(h(),y("i",Ee))]),_:1}),I(W,{name:"package-info"},{default:C(()=>[b(e("aside",Re,[I(Ue,{modelValue:t(f).rootModule,"onUpdate:modelValue":P[0]||(P[0]=_=>t(f).rootModule=_),currentPackage:t(i),onClose:t(s)},null,8,["modelValue","currentPackage","onClose"])],512),[[v,t(n)]])]),_:1})]))}});const Qe=Y(Le,[["__scopeId","data-v-17e368f1"]]);export{Qe as default};
