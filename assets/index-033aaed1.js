import{d as j,s as x,r as C,C as D,e as K,o as f,p as B,h as b,a as e,t as c,w as h,j as m,b as t,c as k,k as V,F as z,l as O,g as y,T as N,_ as G}from"./index-b12f44f1.js";import{e as U,d as T,_ as W,a as E,b as M,k as R,g as A}from"./ForceChart.vue_vue_type_script_setup_true_lang-4d8647aa.js";function $(a){return new Promise((n,o)=>{a.oncomplete=a.onsuccess=()=>n(a.result),a.onabort=a.onerror=()=>o(a.error)})}function L(a,n){const o=indexedDB.open(a);o.onupgradeneeded=()=>o.result.createObjectStore(n);const d=$(o);return(g,p)=>d.then(r=>p(r.transaction(n,g).objectStore(n)))}let w;function F(){return w||(w=L("keyval-store","keyval")),w}function H(a,n=F()){return n("readonly",o=>$(o.get(a)))}function J(a,n,o=F()){return o("readwrite",d=>(d.put(n,a),$(d.transaction)))}async function Q(a,n,o){const d=`${o||"https://registry.npmjs.org/"}${a}/${n}`,g=n===""?void 0:await H(d);if(g)return{data:g,error:void 0};const{data:p,error:r}=await U(d,{headers:{"Content-Type":"application/json"},method:"GET"},{afterFetch({data:i}){return n!==""&&J(d,i),{data:i}}}).json();return{error:r.value,data:p.value}}const X={class:"rounded bg-indigo-3 px-1 font-sans text-indigo-8 dark:bg-blue-6 dark:text-blue-2"},Y={class:"flex-grow overflow-auto"},Z={class:"select-none mt-2 flex justify-between items-center gap-2"},q={class:"mr-2 font-bold"},ee={class:"rounded bg-lime-2 px-1 font-sans text-lime-6 dark:bg-lime-6 dark:text-lime-1"},te=e("i",{class:"i-uil-location-point",text:"lg red"},null,-1),se=[te],ne=e("i",{class:"i-uil-focus-target",text:"lg green-6"},null,-1),oe=[ne],ae={class:"my-4"},re={class:"select-none font-bold"},ce={class:"my-2"},de={class:"select-none flex flex-wrap justify-between gap-2"},ie={"my-1":""},le={class:"mr-2 font-bold"},ue={"font-sans":""},pe={"my-1":""},_e={class:"mr-2 font-bold"},ge={"font-sans":""},fe={class:"select-none"},he={class:"mr-2 font-bold"},me={class:"rounded-sm bg-red-1 px-1 font-sans text-red-6 dark:bg-red-1/30 dark:text-red-3"},ke={class:"my-4 select-none"},ve={class:"mr-2 font-bold"},be={flex:"~ wrap items-start",class:"mt-2 gap-1"},ye={flex:"~ wrap col items-start",class:"my-4 gap-1"},we={class:"select-none font-bold"},xe={class:"animate-pulse py-4"},$e=e("span",{class:"mr-2 inline-block h-4 w-1/4 rounded bg-gray"},null,-1),Pe=e("span",{class:"inline-block h-4 w-1/3 rounded bg-gray"},null,-1),Se=e("p",{class:"h-4 rounded bg-gray"},null,-1),Ie=e("p",{class:"h-4 w-3/4 rounded bg-gray"},null,-1),Ce=e("p",{class:"h-4 rounded bg-gray"},null,-1),Ve=e("p",{class:"h-4 rounded bg-gray"},null,-1),ze=[$e,Pe,Se,Ie,Ce,Ve],Ne=j({__name:"PackageInfo",props:{currentPackage:{},modelValue:{}},emits:["update:modelValue"],setup(a,{emit:n}){const o=a,d=T(),{currentRegistry:g}=x(d),p=C(!1),r=C();D(async s=>{if(o.currentPackage.name+o.currentPackage.version==="")return;p.value=!0;const{data:l}=await Q(o.currentPackage.name,o.currentPackage.version,g.value);r.value=l;const _=setTimeout(()=>p.value=!1,300);s(()=>clearTimeout(_))});const i=K(()=>{var s,l,_,u,v,P,S,I;return{description:((s=r.value)==null?void 0:s.description)??"无",dist:{size:(_=(l=r.value)==null?void 0:l.dist)!=null&&_.size?(r.value.dist.size/1024).toFixed(2)+"KB":"UNKNOWN",unpackedSize:(v=(u=r.value)==null?void 0:u.dist)!=null&&v.unpackedSize?(r.value.dist.unpackedSize/1024).toFixed(2)+"KB":"UNKNOWN"},license:((P=r.value)==null?void 0:P.license)??"UNKNOWN",keywords:((S=r.value)==null?void 0:S.keywords)??[],dependencies:Object.entries(((I=r.value)==null?void 0:I.dependencies)??{})}});return(s,l)=>(f(),B(W,{class:"h-[calc(100vh-8rem)] w-xs"},{header:b(()=>[e("code",X,c(s.currentPackage.name),1)]),default:b(()=>{var _;return[h(e("section",Y,[e("div",Z,[e("div",null,[e("span",q,c(s.$t("packageInfo.version")),1),e("code",ee,c(s.currentPackage.version),1)]),e("div",null,[h(e("button",{type:"button",title:"设为根",class:"ma-0 rounded-md border-none pa-1",bg:"transparent hover:gray-2 hover:dark:slate-8",onClick:l[0]||(l[0]=u=>n("update:modelValue",s.currentPackage.name+"@"+s.currentPackage.version))},se,512),[[m,s.currentPackage.version.match(/^\d/)]]),h(e("button",{type:"button",title:"返回主包",class:"ma-0 rounded-md border-none pa-1",bg:"transparent hover:gray-2 hover:dark:slate-8",onClick:l[1]||(l[1]=u=>n("update:modelValue",""))},oe,512),[[m,s.modelValue!==""]])])]),e("div",ae,[e("span",re,c(s.$t("packageInfo.description")),1),e("p",ce,c(t(i).description),1)]),e("div",de,[e("p",ie,[e("span",le,c(s.$t("packageInfo.size")),1),e("code",ue,c(t(i).dist.size),1)]),e("p",pe,[e("span",_e,c(s.$t("packageInfo.unpackedSize")),1),e("code",ge,c(t(i).dist.unpackedSize),1)])]),e("p",fe,[e("span",he,c(s.$t("packageInfo.license")),1),e("code",me,c((_=t(r))==null?void 0:_.license),1)]),h(e("div",ke,[e("span",ve,c(s.$t("packageInfo.keywords")),1),e("div",be,[(f(!0),k(z,null,V(t(i).keywords,u=>(f(),k("code",{class:"rounded-sm bg-cyan-1 px-1 font-sans text-cyan-6 dark:bg-cyan-1/30 dark:text-cyan-3",key:u},c(u),1))),128))])],512),[[m,t(i).keywords.length]]),h(e("div",ye,[e("span",we,c(s.$t("packageInfo.dependencies")),1),(f(!0),k(z,null,V(t(i).dependencies,([u,v])=>(f(),k("li",{class:"px-1",key:u+v},c(u)+"@"+c(v),1))),128))],512),[[m,t(i).dependencies.length!==0]])],512),[[m,!t(p)]]),h(e("section",xe,ze,512),[[m,t(p)]])]}),_:1}))}}),je={class:"h-100vh w-full overflow-hidden"},Be={key:1,class:"i-svg-spinners-blocks-shuffle-3 absolute left-[calc(50%-3rem)] top-[calc(50%-3rem)] text-8xl"},Te={class:"absolute left-4 top-16"},Fe=j({__name:"index",setup(a){const{packageInfoCardVisible:n}=x(T()),o=E(n),d=O({name:"",version:""});function g(l){o(!0),d.version=l.split("@").slice(-1)[0],d.name=l.split("@").slice(0,-1).join("@")}const{graphData:p,moduleConfig:r}=x(M()),{width:i,height:s}=R();return(l,_)=>(f(),k("div",je,[y(N,{name:"chart"},{default:b(()=>[t(p).nodes.length?(f(),B(A,{key:0,width:t(i),height:t(s),viewBox:`${-t(i)/2} ${-t(s)/2} ${t(i)} ${t(s)}`,onNodeClick:g,graphData:t(p)},null,8,["width","height","viewBox","graphData"])):(f(),k("i",Be))]),_:1}),y(N,{name:"package-info"},{default:b(()=>[h(e("aside",Te,[y(Ne,{modelValue:t(r).rootModule,"onUpdate:modelValue":_[0]||(_[0]=u=>t(r).rootModule=u),currentPackage:t(d),onClose:t(o)},null,8,["modelValue","currentPackage","onClose"])],512),[[m,t(n)]])]),_:1})]))}});const Oe=G(Fe,[["__scopeId","data-v-17e368f1"]]);export{Oe as default};
